# Get-UWorld-Questions-from-Anki-History

This Anki add-on generates UWorld question sets based on your recent Anki reviews.


# üìö Get UWorld Questions from Anki History

**Turn your Anki reviews into UWorld tests.** This add-on analyzes your recent Anki study sessions and generates a list of UWorld Question IDs (QIDs) corresponding to the cards you reviewed. It is the perfect tool for **"Incorrects" sessions** or **Spaced Repetition testing**.

## üöÄ Key Features

* **Time-Travel Search:** Generate tests based on reviews from today, the last *X* hours, or a specific date range (e.g., "Questions I studied last weekend").
* **Smart Filtering:** Automatically excludes questions you have already mastered (requires *UWorld Helper*) and questions that are expired/invalid.
* **Horizontal "Tree" Search:** Finds questions *related* to your reviews, even if you didn't review that specific card directly.
* **Custom Test Mixing:** Decide exactly how much of your test should be "Direct History" vs. "Related Concepts."
* **Persistent Blocklist:** Remembers invalid QIDs so you never have to remove them twice.

---

## üì• Installation

1. **Download** this repository (Code -> Download ZIP) and extract it.
2. Open Anki.
3. Go to **Tools** -> **Add-ons** -> **View Files**.
4. Drag and drop the extracted folder (containing `__init__.py` and `meta.json`) into the Anki add-ons folder.
5. **Restart Anki**.

*(Note: This add-on works best when paired with the **UWorld Helper** add-on for the sidebar browser.)*

---

## ‚ö° Quick Start Guide

1. **Study your cards** in Anki as usual.
2. Go to **Tools** -> **Get UWorld IDs from History**.
3. Select your **Timeframe** (e.g., "Reviewed Today").
4. Click **Generate Question List**.
5. Click **Copy to Clipboard**.
6. Paste the IDs into the **UWorld "Custom Test"** search bar.

---

## üß† Smart Filtering (The "Memory" System)

This add-on is designed to learn what you know and what doesn't exist.

### 1. Excluding "Mastered" Questions

The add-on can communicate with the **UWorld Helper** sidebar to see which questions you have already answered correctly.

* **How it works:** If you have the "Include Correct" checkbox **unchecked**, the add-on reads the `correct_questions.txt` file generated by the sidebar and hides those IDs from your generated list.
* **Benefit:** You stop wasting time re-doing questions you already know.

### 2. Blocking "Invalid" Questions

Sometimes UWorld IDs expire or change.

* **The Problem:** You paste 40 IDs, and UWorld says *"Error: QID 1234, 5678 are invalid."*
* **The Solution:**
  1. Copy that error message from UWorld.
  2. In the add-on, click **Remove Bad IDs from Error...**
  3. Paste the message.
  4. **Result:** The add-on removes them from your current list *and* saves them to a permanent blocklist (`invalid_questions.txt`). It will never suggest them again.

---

## üå≥ Deep Dive: Horizontal (Tree) Search

This is the add-on's most powerful feature. Instead of just testing you on the *exact* card you reviewed, it finds **connections**.

### What is it?

If you reviewed a card about "Heart Failure" that links to UWorld QID `100`, Horizontal Search looks for **other cards** in your deck that *also* tag QID `100`. Then, it grabs *their* UWorld tags to find QID `101`, `102`, etc.

### Settings Explained

* **Layers (Degrees of Separation):**
  * **Layer 1:** Finds "Sibling cards" (cards that share a QID with your reviewed card).
  * **Layer 2:** Finds "Cousin cards" (related to the siblings).
  * *Recommendation:* Start with **Layer 1** to keep topics relevant.
* **Batch Share (%):**
  * Controls the mix of your test.
  * **0%:** Pure history (only cards you actually touched).
  * **50%:** Half the test is cards you reviewed; half is related concepts (great for broadening knowledge).
  * **100%:** Pure discovery mode (only related concepts).

---

## üéõÔ∏è Interface Pro-Tips

### The "Refill" Checkbox

Located under *Batch Size*, this controls what happens when you filter out questions.

* **Checked:** If you ask for 40 questions and 5 are removed because they are "Invalid," the add-on immediately fetches 5 *new* questions to get you back to 40.
* **Unchecked (Default):** Removing 5 questions leaves you with a smaller test (35 questions). This prevents infinite loops if your search yields mostly invalid IDs.

### Randomize Order

* **Checked:** Shuffles your "History" questions and "Horizontal" questions together. This mimics a real randomized test block.
* **Unchecked:** Keeps them sorted numerically.

---

## üí° Workflow for Success

To get the most out of the "Smart Filtering," follow this daily loop:

1. **Do your Anki Reviews.**
2. **Generate a Test** using this History Fetcher.
3. **Take the Test** in the UWorld Sidebar.
4. **üö® CRITICAL STEP:** When you finish the test, go to the UWorld Results screen and run **"Scan Test Results"** (Cmd+Shift+S) using the *UWorld Helper* sidebar.
   * *Why?* This records which questions you got **Correct**.
   * *Result:* Tomorrow, the History Fetcher will know NOT to show you those questions again!

---

## ‚ùì Troubleshooting

**"No IDs found matching criteria."**

* Check your timeframe. Did you actually do reviews in the selected window?
* Check your Card States. If you only did "Learning" cards but unchecked the "Learning" box, nothing will show.

**"UWorld says the IDs don't exist."**

* Use the **Remove Bad IDs** button! Paste the error message there. The add-on will learn to ignore them forever.

**"The list is mostly related questions, not my reviews."**

* Check your **Batch Share** slider. If it's set to high (e.g., 80%), the add-on is prioritizing related "Tree Search" questions over your direct reviews. Slide it down to 0-20% for a more focused session.
